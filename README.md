# «Индексы»
# Александр Широбоков
## Задание 1
### Напишите запрос к учебной базе данных, который вернёт процентное отношение общего размера всех индексов к общему размеру всех таблиц.
![Снимок экрана (233)](https://github.com/AleksandrShirobokov/12.05-Indices/assets/69298696/2473c8ae-d0fd-4375-a3e4-30c16335443d)
```
SELECT (SUM(INDEX_LENGTH) / SUM(DATA_LENGTH)) * 100 AS отношение_индекса_к_таблице
FROM information_schema.TABLES
WHERE TABLE_SCHEMA = 'sakila';
```
## Задание 2
### Выполните explain analyze следующего запроса:
```
select distinct concat(c.last_name, ' ', c.first_name), sum(p.amount) over (partition by c.customer_id, f.title)
from payment p, rental r, customer c, inventory i, film f
where date(p.payment_date) = '2005-07-30' and p.payment_date = r.rental_date and r.customer_id = c.customer_id and i.inventory_id = r.inventory_id
```
 - перечислите узкие места;
 - оптимизируйте запрос: внесите корректировки по использованию операторов, при необходимости добавьте индексы.
## Задание 3
### Самостоятельно изучите, какие типы индексов используются в PostgreSQL. Перечислите те индексы, которые используются в PostgreSQL, а в MySQL — нет.
 - GIN (Generalized Inverted Index): Этот тип индекса используется для поиска по элементам не только простых данных, таких как числа или строки, но и для поиска по сложным структурам данных, таким как массивы, JSON-объекты или полнотекстовые документы. GIN-индекс позволяет эффективно выполнять операции поиска и запросы, связанные с поиском с использованием таких структур данных.

 - GiST (Generalized Search Tree): Этот тип индекса предоставляет возможность создавать пользовательские алгоритмы индексирования для различных типов данных. GiST-индексы поддерживают поиск на основе разных алгоритмов, таких как поиск по диапазонам, полнотекстовый поиск, географический поиск и другие.

 - BRIN (Block Range Index): Этот тип индекса используется для индексирования больших таблиц с отсортированными данными. BRIN-индекс делит данные на блоки и сохраняет минимальные и максимальные значения блоков. Это позволяет эффективно выполнить операции поиска и агрегации на основе диапазонов значений.

 - SP-GiST (Space-Partitioned Generalized Search Tree): Этот тип индекса используется для поиска и индексирования сложных данных, таких как геометрические формы, текстовые документы и другие. SP-GiST-индексы позволяют создавать пользовательские алгоритмы индексирования для различных типов данных.

 - B-tree с сортировкой по обратному порядку: В PostgreSQL B-tree-индексы поддерживают возможность создания индексов, отсортированных по обратному порядку. Это полезно, когда требуется выполнить операции сортировки и поиска в обратном порядке.
